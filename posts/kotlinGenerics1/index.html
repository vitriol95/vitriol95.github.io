<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="코틀린 지네릭스 - 1" /><meta property="og:locale" content="ko" /><meta name="description" content="Variant in Java" /><meta property="og:description" content="Variant in Java" /><link rel="canonical" href="https://vitriol95.github.io/posts/kotlinGenerics1/" /><meta property="og:url" content="https://vitriol95.github.io/posts/kotlinGenerics1/" /><meta property="og:site_name" content="Vitriol" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-02T12:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="코틀린 지네릭스 - 1" /><meta name="twitter:site" content="@" /><meta name="google-site-verification" content="QsbP4NOwVkaE8CnHpYOl-qNGhxB9m1RbsrBEefA92ao" /> <script type="application/ld+json"> {"headline":"코틀린 지네릭스 - 1","dateModified":"2021-10-02T12:00:00+09:00","datePublished":"2021-10-02T12:00:00+09:00","description":"Variant in Java","url":"https://vitriol95.github.io/posts/kotlinGenerics1/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://vitriol95.github.io/posts/kotlinGenerics1/"},"@context":"https://schema.org"}</script><title>코틀린 지네릭스 - 1 | Vitriol</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Vitriol"><meta name="application-name" content="Vitriol"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-WSY4XYN711"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-WSY4XYN711'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Vitriol</a></div><div class="site-subtitle font-italic">기억을 적는 시간</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/vitriol95" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['vitriol951','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>코틀린 지네릭스 - 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>코틀린 지네릭스 - 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> vitriol </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Oct 2, 2021, 12:00 PM +0900" prep="on" > Oct 2, 2021 <i class="unloaded">2021-10-02T12:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1802 words">10 min</span></div></div><div class="post-content"><h2 id="variant-in-java">Variant in Java</h2><h4 id="가장-먼저-다음의-상황을-가정해-보자">가장 먼저 다음의 상황을 가정해 보자.</h4><ul><li>1 - Animal이라는 클래스를 상속한 Dog이라는 클래스가 존재한다.<li>2 - Group<T> 라는 지네릭 인터페이스가 존재하며, 다음과 같은 추상 메서드가 존재한다 </T><ul><li>void insert(T item)<li>T fetch()</ul></ul><h4 id="이를-사용함에-있어-다음과-같은-문제를-맞닥뜨렸을-것이다">이를 사용함에 있어 다음과 같은 문제를 맞닥뜨렸을 것이다.</h4><ul><li>3 - 하지만 <code class="language-plaintext highlighter-rouge">Group&lt;Dog&gt;</code>은 <code class="language-plaintext highlighter-rouge">Group&lt;Animal&gt;</code>의 하위 클래스가 아니다.</ul><h4 id="2번에-대한-문제를-해결한다는-것은-곧-형식-매개변수가-클래스-계층에도-영향을-주는-것에-해당하며-가변성variance을-준다를-의미한다-">2번에 대한 문제를 해결한다는 것은 곧 ‘형식 매개변수가 클래스 계층에도 영향을 주는 것’에 해당하며 ‘가변성(variance)을 준다’를 의미한다. <br /></h4><blockquote><p>그리고 우리는 지네릭스의 upper, lower bound를 클래스 선언부나 메서드 args에 붙혀 이 문제를 해결했을 것이다.</p><ul><li><code class="language-plaintext highlighter-rouge">Group&lt;T extends Animal&gt;</code> or <code class="language-plaintext highlighter-rouge">Group&lt;T super Dog&gt;</code><li><code class="language-plaintext highlighter-rouge">void insert(Group&lt;T extends Animal&gt; animalGroups)</code></ul></blockquote><h4 id="코틀린에서도-당연히-위와-같은-지네릭스를-다룰-수-있는-키워드가-존재한다-앞선-상황을-포함하여-이들을-어떻게-해결하는지-알아보자">코틀린에서도 당연히 위와 같은 지네릭스를 다룰 수 있는 키워드가 존재한다. 앞선 상황을 포함하여, 이들을 어떻게 해결하는지 알아보자.</h4><h2 id="variance-in-detail">Variance in detail</h2><h4 id="가장-먼저-다음과-같은-용어들-정리가-필요하다-앞선-animal과-dog-group의-예시를-그대로-가져오겠다">가장 먼저 다음과 같은 용어들 정리가 필요하다. 앞선 Animal과 Dog, Group의 예시를 그대로 가져오겠다.</h4><ol><li>기본상황 <code class="language-plaintext highlighter-rouge">Animal &lt;- Dog </code>(Super - Sub relation)<li>무변성(Invariance) <code class="language-plaintext highlighter-rouge">Group&lt;Animal&gt; Group&lt;Dog&gt;</code> (No relation)<li>공변성(Covariance) <code class="language-plaintext highlighter-rouge">Group&lt;Animal&gt; &lt;- Group&lt;Dog&gt;</code><blockquote><p>코틀린에서는 out이라는 키워드가 사용 된다.</p></blockquote><li>반공변성(Contravariance) <code class="language-plaintext highlighter-rouge">Group&lt;Dog&gt; &lt;- Group&lt;Animal&gt;</code><blockquote><p>in 이라는 키워드가 사용된다.</p></blockquote></ol><h4 id="1번은-상속에-의해-이루어지는-당연한-관계에-해당하고-2번은-일반-지네릭의-성질에-해당하므로-우리가-알아야-할-것은-34번에-해당한다">1번은 상속에 의해 이루어지는 당연한 관계에 해당하고, 2번은 일반 지네릭의 성질에 해당하므로 우리가 알아야 할 것은 3,4번에 해당한다.</h4><blockquote><p>코틀린에서는 형식 매개변수에 in, out등의 키워드가 존재하지 않으면 모두 2의 관계를 가지게 된다.</p></blockquote><h2 id="공변covariance---out-키워드">공변(Covariance) - out 키워드</h2><h4 id="3번의-상황으로-매개변수의-상하관계가-인스턴스-자료형-관계로도-이어지는-것을-이야기-한다-이때-out키워드를-사용한다">3번의 상황으로 매개변수의 상하관계가 인스턴스 자료형 관계로도 이어지는 것을 이야기 한다. 이때 out키워드를 사용한다.</h4><blockquote><p>앞선 Animal, Dog, Group으로 예시를 들어 보자.</p></blockquote><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>    <span class="kd">class</span> <span class="nc">Group</span><span class="p">&lt;</span><span class="k">out</span> <span class="nc">T</span><span class="p">&gt;(</span><span class="k">private</span> <span class="kd">val</span> <span class="py">elem</span><span class="p">:</span><span class="nc">T</span><span class="p">){</span>
        <span class="k">fun</span> <span class="nf">getT</span><span class="p">():</span> <span class="nc">T</span> <span class="p">=</span> <span class="n">elem</span>
    <span class="p">}</span>
    <span class="k">open</span> <span class="kd">class</span> <span class="nc">Animal</span><span class="p">{</span>
        <span class="k">open</span> <span class="k">fun</span> <span class="nf">sounds</span><span class="p">(){</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"animal's sound"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">Dog</span><span class="p">:</span> <span class="nc">Animal</span><span class="p">(){</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">sounds</span><span class="p">(){</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"dog barks"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="kd">val</span> <span class="py">animalGroup</span> <span class="p">:</span> <span class="nc">Group</span><span class="p">&lt;</span><span class="nc">Animal</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">Group</span><span class="p">&lt;</span><span class="nc">Dog</span><span class="p">&gt;(</span><span class="nc">Dog</span><span class="p">())</span>
        <span class="kd">val</span> <span class="py">anyGroup</span> <span class="p">:</span> <span class="nc">Group</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nc">Group</span><span class="p">&lt;</span><span class="nc">Animal</span><span class="p">&gt;(</span><span class="nc">Animal</span><span class="p">())</span>
        <span class="n">animalGroup</span><span class="p">.</span><span class="nf">getT</span><span class="p">().</span><span class="nf">sounds</span><span class="p">()</span> <span class="c1">// "dog barks"</span>
    <span class="p">}</span>
</pre></table></code></div></div><h4 id="이처럼-groupanimal의-자료형에-groupdog의-인스턴스를-부여할-수-있게-되고-우리는-앞선-문제점을-해결할-수-있게-된다">이처럼 <code class="language-plaintext highlighter-rouge">Group&lt;Animal&gt;</code>의 자료형에 <code class="language-plaintext highlighter-rouge">Group&lt;Dog&gt;</code>의 인스턴스를 부여할 수 있게 되고, 우리는 앞선 문제점을 해결할 수 있게 된다.</h4><blockquote><p><code class="language-plaintext highlighter-rouge">class Group&lt;out T:Animal&gt;</code> 로 UpperBound를 줄 수 있다! 이렇게 되면 <code class="language-plaintext highlighter-rouge">Group&lt;Any&gt;</code>로 캐스팅은 불가능해진다.</p></blockquote><p><br /></p><h4 id="그럼-이런-성질을-활용하는-예시또한-살펴보자-함수의-param으로-사용">그럼 이런 성질을 활용하는 예시또한 살펴보자. (함수의 param으로 사용)</h4><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">copy</span><span class="p">(</span><span class="n">from</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;,</span> <span class="n">to</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;){</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">from</span><span class="p">.</span><span class="n">size</span> <span class="p">==</span> <span class="n">to</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="n">from</span><span class="p">.</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">to</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kd">val</span> <span class="py">ints</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nf">arrayOf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">any</span> <span class="p">=</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;(</span><span class="mi">3</span><span class="p">){</span><span class="s">""</span><span class="p">}</span>
    <span class="nf">copy</span><span class="p">(</span><span class="n">ints</span><span class="p">,</span> <span class="n">any</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>어떤 작업을 하려 하는지는 알 것이다. 위 코드를 실행하면 당연히 컴파일 오류가 발생한다. <code class="language-plaintext highlighter-rouge">Array&lt;Any&gt;</code>와 <code class="language-plaintext highlighter-rouge">Array&lt;Int&gt;</code>는 Invariance 관계이기 때문이다. 위 코드가 작동되게 하려면 copy 함수를 다음과 같이 수정하면 된다.</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">copy</span><span class="p">(</span><span class="n">from</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="k">out</span> <span class="nc">Any</span><span class="p">&gt;</span> <span class="n">to</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">Any</span><span class="p">&gt;){</span>
    <span class="nf">assert</span><span class="p">(</span><span class="n">from</span><span class="p">.</span><span class="n">size</span> <span class="p">==</span> <span class="n">to</span><span class="p">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="n">from</span><span class="p">.</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">to</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p>out키워드가 들어간 순간 Any와 상속관계가 있는 클래스들이 Array의 Type param으로 들어올 수 있다.</p></blockquote><blockquote><p>여기서도 마찬가지로, 자바의 <code class="language-plaintext highlighter-rouge">Array&lt;? extends Object&gt;</code>와 비슷한 면이 있다.</p></blockquote><h4 id="위-작업에서-파라미터-from의-성질은-다음과-같다">위 작업에서, 파라미터 from의 성질은 다음과 같다.</h4><ul><li>Simple Array가 아닌, Restricted Array가 된다.<ul><li>즉, 위의 예시에서는 <code class="language-plaintext highlighter-rouge">Array&lt;Int&gt;</code>로 type projection이 진행된 형태이다.</ul><li>따라서 우리는 type parameter T를 리턴값으로 얻어올 수 있다.</ul><h4 id="이렇게-우리는-projection된-type-parameter를-return할-수-있기-때문에-이를-out-키워드를-이용해-사용하게-되는-것이다">이렇게 우리는 projection된 type parameter를 return할 수 있기 때문에 이를 out 키워드를 이용해 사용하게 되는 것이다.</h4><blockquote><p>can only be produces and never consumed <br /></p></blockquote><h2 id="반공변성contravariance---in">반공변성(Contravariance) - In</h2><h4 id="out과-반대의-방향으로-관계를-맺게-해준다-이번엔-바로-예시로-부터-접근해보자">out과 반대의 방향으로 관계를 맺게 해준다. 이번엔 바로 예시로 부터 접근해보자.</h4><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">interface</span> <span class="nc">Comparable</span><span class="p">&lt;</span><span class="k">in</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">operator</span> <span class="k">fun</span> <span class="nf">compareTo</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="nc">T</span><span class="p">):</span> <span class="nc">Int</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">demo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nc">Comparable</span><span class="p">&lt;</span><span class="nc">Number</span><span class="p">&gt;){</span>
    <span class="n">x</span><span class="p">.</span><span class="nf">compareTo</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">y</span><span class="p">:</span> <span class="nc">Comparable</span><span class="p">&lt;</span><span class="nc">Double</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">x</span> 
<span class="p">}</span>
</pre></table></code></div></div><p>위 코드는 실제 Comparable 인터페이스의 코드에 해당한다. in의 경우 out과 비교했을때, 관계가 역전된 상태이므로 <code class="language-plaintext highlighter-rouge">Comparable&lt;Double&gt;</code>타입이 <code class="language-plaintext highlighter-rouge">Comparable&lt;Number&gt;</code>인스턴스를 가져갈 수 있다. 따라서 Contra- 라는 접두어가 붙는 것이다.</p><h4 id="다른-예시를-하나-더-살펴보자-함수의-param">다른 예시를 하나 더 살펴보자 (함수의 param)</h4><div class="language-kotlin highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">fill</span><span class="p">(</span><span class="n">dest</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="k">in</span> <span class="nc">String</span><span class="p">&gt;,</span> <span class="n">value</span><span class="p">:</span> <span class="nc">String</span><span class="p">){</span>
    <span class="n">dest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">=</span> <span class="n">value</span>
<span class="p">}</span>
</pre></table></code></div></div><p>여기서 dest에 String에 상위 타입에 해당하는 CharSequence의 array등이 들어갈 수 있게되는 것이다.</p><blockquote><p>마찬가지로 자바의 Array&lt;? super String&gt;과 비슷한 면이 있다.</p></blockquote><h2 id="궁금증">궁금증</h2><h4 id="위의-in-out과-같은-키워드를-사용할-때-특이한점을-느꼈다">위의 in, out과 같은 키워드를 사용할 때 특이한점을 느꼈다.</h4><ul><li>out T가 붙은경우(covar) 리턴값으로 T가 나올 수 있으나, input값으로 쓰이지 못한다(컴파일 에러)<li>in T가 붙은경우(contravar) input 값으로 T가 쓰일 수 있으나, 리턴값으로 쓰이지 못한다(컴파일 에러)</ul><h4 id="하지만-이-특이한점들은-앞선-cocontra---var-스키마근본적으로는-super-sub-class의-이해에-연장선에-해당했다">하지만 이 특이한점들은 앞선 co,contra - var 스키마(근본적으로는 super-sub class)의 이해에 연장선에 해당했다.</h4><p>기본적인 2원칙을 상기해보자.</p><ul><li>ㄱ. A subtype must accept <strong><em>at least the same range of types</em></strong> as its supertype declares.<li>ㄴ. A subtype must return <strong><em>at most the same range of types</em></strong> as its supertype declares.</ul><ol><li>가장 먼저 out이 붙은 경우 T의 하위 클래스들이 타입 파라미터로 자리할 수 있다.<ul><li>우리는 리턴값으로 projected parameter인 T를 뱉을 수 있다.<li>하지만 T를 함수의 input으로 사용하여 다룰 수 없다. <code class="language-plaintext highlighter-rouge">Group&lt;out Animal&gt;</code>로 예시를 들어보자</ul><ul><li><code class="language-plaintext highlighter-rouge">insert(newAnimal: T)</code> 로 선언한 순간 이 T엔 projected parameter가 자리한다.<li>이때 <code class="language-plaintext highlighter-rouge">T.method()</code> 를 호출할 수 없다. T는 Animal의 하위타입이기에 없는 프로퍼티들이 존재할 수 있기 때문이다.<li>즉 2원칙중 ㄱ에 위배된다.</ul><li>in이 붙은경우 T의 상위 클래스들이 타입 파라미터로 자리할 수 있다.<ul><li>T를 함수의 input으로 받아 다룰 수 있게된다.</ul><ul><li><code class="language-plaintext highlighter-rouge">Group&lt;in Dog&gt;</code>의 경우 Dog은 상위 클래스들의 프로퍼티를 모두 가지고(or 오버라이딩) 있기때문에 <code class="language-plaintext highlighter-rouge">T.method()</code>, <code class="language-plaintext highlighter-rouge">T.property()</code>에 접근이 가능하다. - 하지만 리턴값으로 projected parameter인 T를 뱉을 수 없다.<li>앞서 이야기한 2원칙의 ㄴ에 위배되므로 지네릭이 깨지게 된다.</ul></ol><h2 id="참고자료">참고자료</h2><ul><li><a href="https://kotlinlang.org/docs/generics.html">https://kotlinlang.org/docs/generics.html</a><li><a href="https://typealias.com/guides/ins-and-outs-of-generic-variance/">https://typealias.com/guides/ins-and-outs-of-generic-variance/</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kotlin/'>Kotlin</a>, <a href='/categories/kotlin-study/'>kotlin_study</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kotlin/" class="post-tag no-text-decoration" >kotlin</a> <a href="/tags/jvm/" class="post-tag no-text-decoration" >jvm</a> <a href="/tags/generics/" class="post-tag no-text-decoration" >generics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=코틀린 지네릭스 - 1 - Vitriol&url=https://vitriol95.github.io/posts/kotlinGenerics1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=코틀린 지네릭스 - 1 - Vitriol&u=https://vitriol95.github.io/posts/kotlinGenerics1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=코틀린 지네릭스 - 1 - Vitriol&url=https://vitriol95.github.io/posts/kotlinGenerics1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/batchbase1/">스프링 배치 - 1 스프링 배치란?</a><li><a href="/posts/batchbase2/">스프링 배치 - 2 DB 스키마에 대한 이해</a><li><a href="/posts/batchbase3/">스프링 배치 - 3 도메인 뜯어보기(JOB)</a><li><a href="/posts/batchbase4/">스프링 배치 - 4 도메인 뜯어보기(STEP)</a><li><a href="/posts/batchbase5/">스프링 배치 - 5 청크 지향 처리</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/python3/">python3</a> <a class="post-tag" href="/tags/boj/">boj</a> <a class="post-tag" href="/tags/problem/">problem</a> <a class="post-tag" href="/tags/%EB%B0%B1%EC%A4%80/">백준</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring-mvc/">spring mvc</a> <a class="post-tag" href="/tags/springframework/">springframework</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/kotlinGenerics2/"><div class="card-body"> <span class="timeago small" > Oct 2, 2021 <i class="unloaded">2021-10-02T13:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>코틀린 지네릭스 - 2</h3><div class="text-muted small"><p> In Out 지난 내용을 요약하면 in / out으로 지네릭에 flexibility를 주는 것을 보았다. projected된 지네릭 파라미터를 읽고싶을 때에는 out을 사용하고, 이를 내부에서 사용하고 싶을때에는 in이라는 키워드를 사용하면 된다. 하지만 이런 궁금증도 든다, 이 둘을 동시에 사용하는 방법이 있을까?? 가장 먼저 생각할 수 있는 ...</p></div></div></a></div><div class="card"> <a href="/posts/kotlinStudy1/"><div class="card-body"> <span class="timeago small" > Oct 2, 2021 <i class="unloaded">2021-10-02T11:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>코틀린 var, val 그리고 inline</h3><div class="text-muted small"><p> 인터페이스 상에서의 var과 val의 차이 코틀린에서 ‘var속성과 val속성을 사용한다.’ 라는 것은 결국 ‘속성 처럼’ 보이는 문법을 쓰게 해주는 getter나 setter를 만들어주는 것이다. 또한 이러한 특징은 추상 클래스나 인터페이스에서 추상 수준의 var이나 val을 사용할 수 있게 해준다. 그렇다면 다음과 같은 선언을 보자. 이번 프...</p></div></div></a></div><div class="card"> <a href="/posts/kotlinCompanionObject/"><div class="card-body"> <span class="timeago small" > Oct 4, 2021 <i class="unloaded">2021-10-04T13:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>코틀린의 CompanionObject vs 자바 Static</h3><div class="text-muted small"><p> Kotlin + Companion Object 출처 출처2 코틀린에서의 Companion Object는 자바의 Static과 엄연히 다르다. 그렇다면 왜 기존의 Static을 쓰지 않고 코틀린에와서 이렇게 넘어오게 됬는지, 그 연유를 찾아 올라가면 알 수 있지 않을까? 자바의 Static &amp; 코틀린의 Object 자바에서의 static...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/kotlinStudy1/" class="btn btn-outline-primary" prompt="Older"><p>코틀린 var, val 그리고 inline</p></a> <a href="/posts/kotlinGenerics2/" class="btn btn-outline-primary" prompt="Newer"><p>코틀린 지네릭스 - 2</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">vitriol</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/python3/">python3</a> <a class="post-tag" href="/tags/boj/">boj</a> <a class="post-tag" href="/tags/problem/">problem</a> <a class="post-tag" href="/tags/%EB%B0%B1%EC%A4%80/">백준</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/springboot/">springboot</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring-mvc/">spring mvc</a> <a class="post-tag" href="/tags/springframework/">springframework</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://vitriol95.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
